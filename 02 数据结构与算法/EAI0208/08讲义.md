# EAI｜02.8 数据结构与算法 课程讲义  
课程名称：数据结构与算法  
单元主题：队列结构｜智能任务流引擎  
授课年级：G3+  
计划课时：90分钟  


## 课程概括  
本课以机器人咖啡工坊为场景，系统学习队列结构的FIFO特性及其在任务调度中的核心作用。通过构建多级任务流水线和优先级队列系统，掌握队列的底层实现与高阶应用，培养并行任务处理能力，为后续实时操作系统开发打下坚实基础。  

## 教学目标  
### 🎯知识与技能  
1. 掌握deque的双端操作（appendleft/popleft）  
2. 理解生产者-消费者模型的队列实现  
3. 熟练设计多优先级任务调度系统  

### 🎯过程与方法  
1. 通过流水线模拟理解并发队列机制  
2. 采用事件驱动法优化任务处理流程  

### 🎯情感态度价值观  
1. 培养任务编排的系统工程思维  
2. 增强服务化设计的用户体验意识  

## 重点难点  
| 教学重点 | 教学难点 |  
|----------|----------|  
| ✅ 队列的线程安全实现 | ⚠️ 队列阻塞与死锁预防 |  
| ✅ 优先级队列的堆实现 | ⚠️ 任务饥饿现象优化策略 |  
| ✅ 任务状态的持久化存储 | ⚠️ 分布式队列的一致性维护 |  

## 教学准备  
| 软件 | 硬件 | 扩展 |  
|------|------|------|  
| Python 3.10+ | 　 | [流水线模拟器](https://bit.ly/8queue_sim) |  
| Redis-Py | 　 | [任务监控仪表盘](https://bit.ly/8task_monitor) |  

## 教学过程  
| 环节 | 主要内容 | 预计时长 | 素材附件 |  
|------|----------|----------|----------|  
| 环节1: 情境导入 | ● 播放星巴克自动化咖啡机工作视频<br>● 分析订单队列处理流程 | 12分钟 | [生产线视频](https://bit.ly/8coffee_line) |  
| 环节2: 队列结构解析 | ● 对比机场安检通道（FIFO）<br>● 演示deque的线程安全操作<br>● 实现急诊科分级诊疗队列 | 25分钟 | [队列可视化](https://bit.ly/8queue_vis) |  
| 环节3: 任务调度实战 | ● 基础订单队列实现（先进先出）<br>● VIP优先队列设计（优先级插队）<br>● 超时订单自动取消机制 | 20分钟 | [订单生成器](https://bit.ly/8order_gen) |  
| 环节4: 具身实践 | ● 基础组：单线程咖啡制作流<br>● 进阶组：多工位并行调度<br>● 挑战组：拿铁艺术图案队列 | 28分钟 | [拿铁模拟器](https://bit.ly/8latte_art) |  
| 环节5: 总结提升 | ● 分布式队列架构解析<br>● 展示Kafka消息队列工业案例 | 5分钟 | [Kafka白皮书](https://bit.ly/8kafka_doc) |  

## 课程总结  
| 内容 | 主要内容 | 预计时长 | 素材附件 |  
|------|----------|----------|----------|  
| A 拓展任务 | ● 实现语音订单插队功能<br>● 设计冷热饮分区队列 | - | - |  
| B 课程总结 | ● 队列类型决策树<br>● 任务丢失事故分析 | - | - |  
| C 课后作业 | ● 优化队列吞吐量<br>● 预习树形结构 | - | - |  

---

### 工业级功能扩展：  
1. ​**流水线模拟器**支持以下高级特性：  
   - 动态调整工位数量（2-8个并行队列）  
   - 模拟设备故障（自动转移任务队列）  
   - 实时吞吐量统计报表  
2. ​**拿铁模拟器**包含：  
   - 20种咖啡拉花图案模板  
   - 奶泡厚度传感器模拟数据流  
   - 制作过程回放功能（带错误标注）  
3. ​**任务监控仪表盘**可追踪：  
   - 任务生命周期（等待→执行→完成）  
   - 工位负载均衡热力图  
   - 超时任务自动告警  

```python
# 优先级队列实现示例
from collections import deque
import heapq

class PriorityQueue:
    def __init__(self):
        self._heap = []
        
    def enqueue(self, task, priority=0):
        heapq.heappush(self._heap, (-priority, task))
        
    def dequeue(self):
        return heapq.heappop(self._heap)[1]

# 咖啡订单处理
orders = PriorityQueue()
orders.enqueue("美式咖啡", 1)
orders.enqueue("VIP卡布奇诺", 3)
print(orders.dequeue())  # 输出：VIP卡布奇诺